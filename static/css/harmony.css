/* 
 * HarmonyOS Specific Optimizations
 * 针对华为鸿蒙系统的优化
 */

/* 安全区域适配 */
:root {
    --safe-area-inset-top: env(safe-area-inset-top, 0px);
    --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
    --safe-area-inset-left: env(safe-area-inset-left, 0px);
    --safe-area-inset-right: env(safe-area-inset-right, 0px);
}

/* 华为/鸿蒙系统专用优化 */
@supports (-webkit-touch-callout: none) or (-webkit-appearance: none) {
    body {
        height: auto !important;
        min-height: 100% !important;
        overflow: auto !important;
    }
    
    /* 修复视觉效果 */
    .navbar {
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
    }
    
    /* 增强触摸体验 */
    a, button, .btn, input[type="submit"], .nav-link {
        touch-action: manipulation;
        -webkit-tap-highlight-color: transparent;
        min-height: 44px;
    }
    
    /* 修复滚动和弹性行为 */
    .table-responsive, .nav-tabs {
        -webkit-overflow-scrolling: touch;
        overscroll-behavior: contain;
        scrollbar-width: none;
        -ms-overflow-style: none;
    }
    
    .table-responsive::-webkit-scrollbar, 
    .nav-tabs::-webkit-scrollbar {
        display: none;
    }
    
    /* 鸿蒙专用下拉菜单修复 */
    .dropdown-menu {
        transform: translateZ(0) !important;
        -webkit-transform: translateZ(0) !important;
        will-change: transform, opacity !important;
        backface-visibility: hidden !important;
        -webkit-backface-visibility: hidden !important;
        overflow: visible !important;
        z-index: 10000 !important;
    }
    
    /* 确保下拉菜单可见性 */
    .dropdown-menu.show {
        display: block !important;
        opacity: 1 !important;
        visibility: visible !important;
        pointer-events: auto !important;
    }
    
    /* 调整下拉菜单项 */
    .dropdown-item {
        padding: 10px 15px !important;
        min-height: 44px !important;
        display: flex !important;
        align-items: center !important;
    }
    
    /* 优化卡片样式 */
    .card {
        box-shadow: 0 1px 3px rgba(0,0,0,0.12) !important;
        border-radius: 8px !important;
        overflow: hidden !important;
    }
    
    .card .card-header {
        padding: 8px 12px !important;
        font-size: 16px !important;
    }
    
    /* 表格样式优化 */
    .table {
        margin-bottom: 0 !important;
    }
    
    .table th {
        font-weight: 500 !important;
        background-color: #f8f9fa !important;
        border-bottom: 1px solid #dee2e6 !important;
        padding: 12px 8px !important;
        text-align: center !important;
    }
    
    .table td {
        padding: 12px 8px !important;
        text-align: center !important;
        vertical-align: middle !important;
    }
    
    /* 标签页优化 */
    .nav-tabs {
        border-bottom: 1px solid #dee2e6 !important;
        margin-bottom: 15px !important;
    }
    
    .nav-tabs .nav-link {
        border: none !important;
        border-bottom: 2px solid transparent !important;
        margin-bottom: -1px !important;
        padding: 10px 15px !important;
        color: #6c757d !important;
    }
    
    .nav-tabs .nav-link.active {
        border-bottom-color: #0d6efd !important;
        color: #0d6efd !important;
        font-weight: 500 !important;
    }
}

/* 额外的鸿蒙OS优化 */
@supports ((-moz-appearance:none) and (display:contents)) or (-webkit-touch-callout: none) {
    /* 修复布局问题 */
    .main-content {
        height: auto !important;
        min-height: calc(100% - var(--navbar-height) - var(--safe-area-inset-top) - var(--safe-area-inset-bottom)) !important;
        flex: 1 0 auto;
    }
    
    /* 防止底部空白 */
    html {
        height: -webkit-fill-available;
    }
    
    body {
        min-height: -webkit-fill-available;
        padding-bottom: calc(var(--safe-area-inset-bottom) + 10px);
    }
}

/* 解决页面底部大量空白问题 */
.card-container {
    height: auto !important;
    max-height: none !important;
    page-break-inside: avoid;
}

/* 修复表格显示 */
.table tr {
    height: auto !important;
    max-height: none !important;
}

/* 增强移动设备性能 */
@media (max-width: 768px) {
    /* 减小资源占用 */
    img, svg {
        max-width: 100%;
        height: auto;
    }
    
    /* 优化触摸体验 */
    .btn {
        min-height: 44px;
        font-size: 0.95rem;
    }
    
    /* 加速过渡效果 */
    * {
        transition-duration: 0.15s !important;
    }
    
    /* 加速页面渲染 */
    .container-fluid, .table, .card {
        will-change: transform;
    }
    
    /* 鸿蒙系统移动端菜单优化 */
    .dropdown-menu {
        position: fixed !important;
        top: calc(var(--navbar-height) + var(--safe-area-inset-top)) !important;
        right: 5px !important;
        left: auto !important;
        min-width: 160px !important;
        max-width: 70vw !important;
        transform: none !important;
        z-index: 99999 !important; /* 超高层叠顺序 */
        border-radius: 8px !important;
        box-shadow: 0 6px 16px rgba(0,0,0,0.3) !important;
        background-color: white !important;
        display: none !important;
        margin: 0 !important;
        padding: 5px 0 !important;
        opacity: 1 !important;
        visibility: visible !important;
    }
    
    .dropdown-menu.show {
        display: block !important;
    }
    
    /* 移动端按钮修复 */
    .navbar-toggler {
        min-height: 44px !important;
        padding: 8px 10px !important;
    }
    
    /* 移动端主页布局优化 */
    .container-fluid {
        padding: 0.5rem !important;
    }
    
    /* 操作按钮优化 */
    .card .btn {
        border-radius: 6px !important;
        height: 50px !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        font-size: 1rem !important;
        font-weight: 500 !important;
    }
    
    /* 卡片样式优化 */
    .card {
        margin-bottom: 10px !important;
        border-radius: 8px !important;
    }
    
    .card-header {
        font-size: 1rem !important;
        padding: 10px 15px !important;
    }
    
    /* 表格样式优化 */
    .table th {
        text-align: center !important;
        font-weight: normal !important;
        font-size: 0.9rem !important;
        padding: 10px 5px !important;
    }
    
    .table td {
        text-align: center !important;
        padding: 12px 5px !important;
        font-size: 0.9rem !important;
    }
    
    /* 日期选择器和导出按钮 */
    input[type="date"] {
        height: 44px !important;
        padding: 0 10px !important;
        border-radius: 6px !important;
    }
    
    .bg-secondary {
        background-color: #6c757d !important;
    }
    
    .bg-secondary .card-body {
        padding: 10px 15px !important;
    }
    
    .bg-secondary .btn {
        border-radius: 6px !important;
        height: 44px !important;
        background-color: #ffffff !important;
        color: #0d6efd !important;
        font-weight: 500 !important;
    }
    
    /* 标签页样式优化 */
    .nav-tabs {
        background-color: #ffffff !important;
        margin-bottom: 5px !important;
        border-radius: 8px !important;
        overflow: hidden !important;
        border: none !important;
    }
    
    .nav-tabs .nav-item {
        flex: 1 !important;
    }
    
    .nav-tabs .nav-link {
        text-align: center !important;
        border-radius: 0 !important;
        padding: 12px 0 !important;
        font-size: 0.9rem !important;
        width: 100% !important;
    }
    
    .tab-content {
        background-color: #ffffff !important;
        border-radius: 8px !important;
        overflow: hidden !important;
        margin-bottom: 20px !important;
    }
} 